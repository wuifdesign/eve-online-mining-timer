!function(s){"use strict";var e,t={"sound-1":"Sound 1","sound-2":"Sound 2","sound-3":"Sound 3","sound-4":"Sound 4","sound-5":"Sound 5","sound-6":"Sound 6","sound-7":"Sound 7"};Vue.filter("time",function(t){var e=Math.floor(t/60),r=t-60*e;return e<10&&(e="0"+e),r<10&&(r="0"+r),e+":"+r}),Vue.filter("number",function(t){return Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}),Vue.filter("toFixed",function(t){var e=Math.round(100*t).toString(),r=e.substr(0,e.length-2).replace(/\B(?=(\d{3})+(?!\d))/g,","),s=Math.round(e.slice(-2));return""===r&&(r=0),s<10&&(s="0"+s),r+"."+s}),Vue.filter("round",{read:function(t){return Math.round(t)},write:function(t){return isNaN(t)?0:Math.round(t)}}),Vue.component("task-row",{template:"#grid-template",replace:!0,props:{data:Object,current_ship:Object,settings:Object,yield_per_sec_m3:Number,"remove-task":{type:Function,required:!0},"add-cargo":{type:Function,required:!0}},data:function(){return{turrets:1,turrets_select:[],running:!1,select:e.select,interval:null}},created:function(){var t=this;this.$on("stop-tasks",function(){t.stop()}),this.updateTurretData()},watch:{current_ship:function(){this.updateTurretData()}},computed:{ore_size:function(){return""===this.data.ore?0:e.size[this.data.ore]},total_ore_size:function(){return isNaN(this.data.count)?0:Math.round(this.data.count*this.ore_size)},ore_per_sec:function(){return this.yield_per_sec_m3/this.ore_size/this.current_ship.turrets*this.turrets},circles:function(){var t=this.total_ore_size/this.current_ship.yield_per_turret/this.turrets;return isNaN(t)||!isFinite(t)?0:t},time:function(){var t=Math.round(this.circles*this.current_ship.circle_time);return isNaN(t)?0:t}},methods:{updateTurretData:function(){if(null!==this.current_ship){this.turrets_select=[];for(var t=1;t<=this.current_ship.turrets;t++)this.turrets_select.push(t);this.current_ship.split_turrets?this.turrets=1:this.turrets=this.current_ship.turrets}},start:function(){var e;this.time<=0||((e=this).interval=setInterval(function(){var t=e.ore_per_sec;e.data.count<e.ore_per_sec&&(t=e.data.count),e.data.count-=e.ore_per_sec,e.addCargo(t*e.ore_size),e.data.count<=0&&(s("#"+e.settings.task_sound)[0].play(),e.data.count=0,e.stop())},1e3),this.running=!0)},stop:function(){clearInterval(this.interval),this.interval=null,this.running=!1},remove:function(){this.removeTask(this.data)}}});function r(){s.each(t,function(t){s("#app-audio-holder").append('<audio id="'+t+'" src="./assets/audio/'+t+'.mp3"></audio>')}),new Vue({el:"#mining-app",data:{cargo:0,sounds:t,scanner_data:"",current_ship_index:null,ships:[],ships_list:[],settings:{cargo_limit:95,task_sound:"sound-1",cargo_full_sound:"sound-1"},tasks:[]},created:function(){this.current_ship_index=localStorage.getItem("current_ship_index");var t=localStorage.getItem("ships");null===t?this.addEmptyShip():this.ships=JSON.parse(t);var e=localStorage.getItem("settings");null!==e&&(this.settings=JSON.parse(e))},watch:{ship_count:function(t){0<t&&null===this.current_ship_index?this.current_ship_index=0:0===t&&(this.current_ship_index=null,localStorage.removeItem("current_ship_index"))},current_ship_index:function(t){void 0!==t&&localStorage.setItem("current_ship_index",t)}},computed:{validShips:function(){return this.ships.filter(function(t){return""!==t.name})},current_ship:function(){var t=this.ships[this.current_ship_index];return void 0===t?{name:"",cargo:0,yield_per_turret:0,circle_time:0,turrets:1,split_turrets:!1}:t},ship_count:function(){var r=0;return s.each(this.ships,function(t,e){""!==e.name&&r++}),r},yield_per_sec_m3:function(){var t=this.current_ship.yield_per_turret*this.current_ship.turrets/this.current_ship.circle_time;return isNaN(t)?0:t},max_cargo:function(){return this.current_ship.cargo},cargo_nearly_full:function(){return 0!==this.current_ship.cargo&&this.cargo>=this.current_ship.cargo*(this.settings.cargo_limit/100)},cargo_full:function(){return 0!==this.current_ship.cargo&&(this.cargo>=this.current_ship.cargo&&(this.$broadcast("stop-tasks"),s("#"+this.settings.cargo_full_sound)[0].play(),!0))},full_cargo_time:function(){var t=Math.round(this.current_ship.cargo/this.yield_per_sec_m3);return isNaN(t)?0:t}},methods:{saveSettings:function(){localStorage.setItem("settings",JSON.stringify(this.settings))},addEmptyShip:function(){this.ships.push({name:"",cargo:0,yield_per_turret:0,circle_time:0,turrets:1})},saveShips:function(){localStorage.setItem("ships",JSON.stringify(this.ships))},removeShip:function(t){this.ships.$remove(t),this.saveShips()},addEmptyTask:function(){this.tasks.push({label:"",ore:"veldspar",count:0})},addCargo:function(t){this.cargo+=t},playSound:function(t){s("#"+t)[0].play()},resetCargo:function(){this.cargo=0},removeTask:function(t){this.tasks.$remove(t)},removeEmptyTasks:function(){var r=this;s.each(this.tasks,function(t,e){0===e.count&&setTimeout(function(){r.tasks.$remove(e)},0)})},parseScannerData:function(){var r=this;setTimeout(function(){var t,a,e=(t=r.scanner_data,a=[],s.each(t.split("\n"),function(t,e){try{var r={},s=e.split("\t");if(4!==s.length)throw console.log("length not 4"),"shorter 4";r.label=s[0]+" - "+s[3],r.count=parseInt(s[1].replace(/\u00a0/g,"").replace(" ","").replace(".","").replace(",",""));var i=s[0].split(" "),n=1<i.length?i[1].toLowerCase():i[0].toLowerCase();switch(n){case"ochre":n="dark ochre";break;case"arisite":n="green arisite";break;case"icicle":n="clear icicle";break;case"glaze":n="white glaze";break;case"ice":n="blue ice";break;case"mass":n="glacial mass";break;case"crust":n="glare crust";break;case"glitter":n="dark glitter"}r.ore=n,a.push(r)}catch(t){}}),a);s.each(e,function(t,e){r.tasks.push({label:e.label,ore:e.ore,count:e.count})}),r.scanner_data=""},10)}}}).addEmptyTask()}s.getJSON("./assets/json/config.json",function(t){e=t,r()})}(jQuery);
//# sourceMappingURL=main.min.js.map
