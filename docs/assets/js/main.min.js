!function(t){"use strict";var e,r=function(e){var r=[];return t.each(e.split("\n"),function(t,e){try{var s={},i=e.split("\t");if(3!=i.length)throw"shorter 3";s.label=i[0]+" - "+i[2],s.count=parseInt(i[1].replace(/\u00a0/g,"").replace(".","").replace(",",""));var n,a=i[0].split(" ");n=a.length>1?a[1].toLowerCase():a[0].toLowerCase(),"ochre"===n?n="dark ochre":"arisite"===n&&(n="green arisite"),s.ore=n,r.push(s)}catch(u){}}),r};Vue.filter("time",function(t){var e=Math.floor(t/60),r=t-60*e;return e<10&&(e="0"+e),r<10&&(r="0"+r),e+":"+r}),Vue.filter("number",function(t){return Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}),Vue.filter("toFixed",function(t){var e=Math.round(100*t).toString(),r=e.substr(0,e.length-2).replace(/\B(?=(\d{3})+(?!\d))/g,","),s=Math.round(e.slice(-2));return""===r&&(r=0),s<10&&(s="0"+s),r+"."+s}),Vue.filter("round",{read:function(t){return Math.round(t)},write:function(t,e){return isNaN(t)?0:Math.round(t)}}),Vue.component("task-row",{template:"#grid-template",replace:!0,props:{data:Object,current_ship:Object,settings:Object,yield_per_sec_m3:Number,"remove-task":{type:Function,required:!0},"add-cargo":{type:Function,required:!0}},data:function(){return{turrets:1,turrets_select:[],running:!1,select:e.select,interval:null}},created:function(){var t=this;this.$on("stop-tasks",function(){t.stop()}),this.updateTurretData()},watch:{current_ship:function(t){this.updateTurretData()}},computed:{ore_size:function(){return""===this.data.ore?0:e.size[this.data.ore]},total_ore_size:function(){return isNaN(this.data.count)?0:Math.round(this.data.count*this.ore_size)},ore_per_sec:function(){var t=this.yield_per_sec_m3/this.ore_size/this.current_ship.turrets;return t*this.turrets},circles:function(){var t=this.total_ore_size/this.current_ship.yield_per_turret/this.turrets;return isNaN(t)||!isFinite(t)?0:t},time:function(){var t=Math.round(this.circles*this.current_ship.circle_time);return isNaN(t)?0:t}},methods:{updateTurretData:function(){if(null!==this.current_ship){this.turrets_select=[];for(var t=1;t<=this.current_ship.turrets;t++)this.turrets_select.push(t);this.current_ship.split_turrets?this.turrets=1:this.turrets=this.current_ship.turrets}},start:function(){if(!(this.time<=0)){var e=this;this.interval=setInterval(function(){var r=e.ore_per_sec;e.data.count<e.ore_per_sec&&(r=e.data.count),e.data.count-=e.ore_per_sec,e.addCargo(r*e.ore_size),e.data.count<=0&&(t("#"+e.settings.task_sound)[0].play(),e.data.count=0,e.stop())},1e3),this.running=!0}},stop:function(){clearInterval(this.interval),this.interval=null,this.running=!1},remove:function(){this.removeTask(this.data)}}});var s=function(){var e=new Vue({el:"#mining-app",data:{cargo:0,scanner_data:"",current_ship_index:null,ships:[],ships_list:[],settings:{cargo_limit:95,task_sound:"sound-1",cargo_full_sound:"sound-1"},tasks:[]},created:function(){this.current_ship_index=localStorage.getItem("current_ship_index");var t=localStorage.getItem("ships");null===t?this.addEmptyShip():this.ships=JSON.parse(t);var e=localStorage.getItem("settings");null!==e&&(this.settings=JSON.parse(e))},watch:{ship_count:function(t){t>0&&null===this.current_ship_index?this.current_ship_index=0:0==t&&(this.current_ship_index=null,localStorage.removeItem("current_ship_index"))},current_ship_index:function(t){"undefined"!=typeof t&&localStorage.setItem("current_ship_index",t)}},computed:{current_ship:function(){var t=this.ships[this.current_ship_index];return"undefined"==typeof t?{name:"",cargo:0,yield_per_turret:0,circle_time:0,turrets:1,split_turrets:!1}:t},ship_count:function(){var e=0;return t.each(this.ships,function(t,r){""!==r.name&&e++}),e},yield_per_sec_m3:function(){var t=this.current_ship.yield_per_turret*this.current_ship.turrets/this.current_ship.circle_time;return isNaN(t)?0:t},max_cargo:function(){return this.current_ship.cargo},cargo_nearly_full:function(){return 0!==this.current_ship.cargo&&this.cargo>=this.current_ship.cargo*(this.settings.cargo_limit/100)},cargo_full:function(){return 0!==this.current_ship.cargo&&(this.cargo>=this.current_ship.cargo&&(this.$broadcast("stop-tasks"),t("#"+this.settings.cargo_full_sound)[0].play(),!0))},full_cargo_time:function(){var t=Math.round(this.current_ship.cargo/this.yield_per_sec_m3);return isNaN(t)?0:t}},methods:{saveSettings:function(){localStorage.setItem("settings",JSON.stringify(this.settings))},addEmptyShip:function(){this.ships.push({name:"",cargo:0,yield_per_turret:0,circle_time:0,turrets:1})},saveShips:function(){localStorage.setItem("ships",JSON.stringify(this.ships))},removeShip:function(t){this.ships.$remove(t),this.saveShips()},addEmptyTask:function(){this.tasks.push({label:"",ore:"veldspar",count:0})},addCargo:function(t){this.cargo+=t},playSound:function(e){t("#"+e)[0].play()},resetCargo:function(){this.cargo=0},removeTask:function(t){this.tasks.$remove(t)},removeEmptyTasks:function(){var e=this;t.each(this.tasks,function(t,r){0===r.count&&setTimeout(function(){e.tasks.$remove(r)},0)})},parseScannerData:function(){var e=this;setTimeout(function(){var s=r(e.scanner_data);t.each(s,function(t,r){e.tasks.push({label:r.label,ore:r.ore,count:r.count})}),e.scanner_data=""},10)}}});e.addEmptyTask()};t.getJSON("./assets/json/config.json",function(t){e=t,s()})}(jQuery);
//# sourceMappingURL=main.min.js.map
